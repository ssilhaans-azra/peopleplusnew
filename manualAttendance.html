<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Arimo:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Manual Attendance</title>
    <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'arimo': ['Arimo', 'sans-serif'],
          }
        }
      }
    }
  </script>
</head>
<body>
  <div class="flex flex-col sm:flex-row gap-4 items-stretch sm:items-center justify-end mb-4">
        <button id="openAttendanceModalBtn" class="px-4 py-2 flex items-center justify-center border border-black rounded-lg hover:bg-gray-50 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M5 12h14"/>
                <path d="M12 5v14"/>
            </svg>
            <p class="ml-2">Add Manual Attendance</p>
        </button>

        <button id="openSettingsModalBtn" class="px-6 py-2 flex items-center justify-center bg-[#9E005D] text-white gap-2 rounded-lg hover:bg-[#7d004a] transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915"/>
                <circle cx="12" cy="12" r="3"/>
            </svg>
            <p>Check-In Settings</p>
        </button>
  </div>
  <div class="flex flex-row gap-4 bg-white px-7 py-4 rounded-xl justify-between">
    <div class="flex border w-[300px] border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded-lg gap-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-[#99A1AF]" width="20" height="20" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search-icon lucide-search">
            <path d="m21 21-4.34-4.34"/>
            <circle cx="11" cy="11" r="8"/>
        </svg>
        <p class="text-[#0A0A0A80]/50 text-[18px] font-normal">Search...</p>
    </div>
    <div class="flex justify-between items-center">
        <div class="relative">
            <!-- Select element with adjusted padding and focus styles -->
            <select id="activityFilter" class="appearance-none bg-[#F3F4F6] border border-gray-300 text-gray-700 py-2 px-4 pr-8 rounded-lg leading-tight focus:outline-none focus:border-[#9E005D] focus:ring-2 focus:ring-[#9E005D]/20 cursor-pointer transition-all w-full">
                <option value="all">All Department</option>
                <option value="attendance">Attendance</option>
                <option value="leave">Leave</option>
                <option value="employee">Employee</option>
                <option value="shift">Shift</option>
                <option value="payroll">Payroll</option>
            </select>
            <!-- SVG icon for dropdown, absolutely positioned on the right -->
            <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700">
                <svg class="fill-current h-4 w-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                <path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/>
                </svg>
            </div>
        </div>
    </div>
  </div>
    <div id="attendanceModalOverlay" class="hidden fixed inset-0 z-[9999] bg-black/50 items-center justify-center overflow-auto">
        <iframe id="attendanceModalIframe" src="manualAttendancePopup.html" class="w-full max-w-[500px] h-[650px] border-0 rounded-xl bg-white shadow-2xl"></iframe>
    </div>

    <!-- Check-In Settings Modal (Modal 2) -->
    <div id="settingsModalOverlay" class="hidden fixed inset-0 z-[9999] bg-black/50 items-center justify-center overflow-auto">
        <iframe id="settingsModalIframe" src="checkInSettingPopup.html" class="w-full max-w-[550px] h-[700px] border-0 rounded-xl bg-white shadow-2xl"></iframe>
    </div>
  <script>
        // Modal elements
        const attendanceModalOverlay = document.getElementById("attendanceModalOverlay");
        const settingsModalOverlay = document.getElementById("settingsModalOverlay");
        const openAttendanceModalBtn = document.getElementById("openAttendanceModalBtn");
        const openSettingsModalBtn = document.getElementById("openSettingsModalBtn");

        // Open Attendance Modal
        openAttendanceModalBtn.onclick = function() {
            attendanceModalOverlay.classList.remove('hidden');
            attendanceModalOverlay.classList.add('flex');
            document.body.classList.add('overflow-hidden');
        }

        // Open Settings Modal
        openSettingsModalBtn.onclick = function() {
            settingsModalOverlay.classList.remove('hidden');
            settingsModalOverlay.classList.add('flex');
            document.body.classList.add('overflow-hidden');
        }

        // Close Attendance Modal when clicking outside iframe
        attendanceModalOverlay.onclick = function(event) {
            if (event.target === attendanceModalOverlay) {
                attendanceModalOverlay.classList.add('hidden');
                attendanceModalOverlay.classList.remove('flex');
                document.body.classList.remove('overflow-hidden');
            }
        }

        // Close Settings Modal when clicking outside iframe
        settingsModalOverlay.onclick = function(event) {
            if (event.target === settingsModalOverlay) {
                settingsModalOverlay.classList.add('hidden');
                settingsModalOverlay.classList.remove('flex');
                document.body.classList.remove('overflow-hidden');
            }
        }

        // Listen for messages from iframes
        window.addEventListener('message', function(event) {
            // Close Attendance Modal
            if (event.data === 'closeModal') {
                attendanceModalOverlay.classList.add('hidden');
                attendanceModalOverlay.classList.remove('flex');
                document.body.classList.remove('overflow-hidden');
            } 
            // Close Settings Modal
            else if (event.data === 'closeSettingsModal') {
                settingsModalOverlay.classList.add('hidden');
                settingsModalOverlay.classList.remove('flex');
                document.body.classList.remove('overflow-hidden');
            }
            // Handle Attendance Form Submission
            else if (event.data.type === 'attendanceSubmitted') {
                console.log('Attendance data received:', event.data.data);
                
                // Add new row to table
                const tableBody = document.getElementById('attendanceTableBody');
                const newRow = document.createElement('tr');
                newRow.className = 'border-b border-gray-100 hover:bg-gray-50';
                
                const data = event.data.data;
                const formatTime = (time) => {
                    const [hours, minutes] = time.split(':');
                    const hour = parseInt(hours);
                    const ampm = hour >= 12 ? 'PM' : 'AM';
                    const displayHour = hour % 12 || 12;
                    return `${displayHour}:${minutes} ${ampm}`;
                };
                
                newRow.innerHTML = `
                    <td class="py-3 px-4 text-gray-700">${data.employeeName}</td>
                    <td class="py-3 px-4 text-gray-700">${data.date}</td>
                    <td class="py-3 px-4 text-gray-700">${formatTime(data.inTime)}</td>
                    <td class="py-3 px-4 text-gray-700">${formatTime(data.outTime)}</td>
                    <td class="py-3 px-4"><span class="px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm">Manual Entry</span></td>
                `;
                
                tableBody.insertBefore(newRow, tableBody.firstChild);
                
                alert('Attendance record added successfully!');
            }
            // Handle Settings Form Submission
            else if (event.data.type === 'settingsSubmitted') {
                console.log('Settings data received:', event.data.data);
                alert('Check-in settings saved successfully!');
            }
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#attendanceTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Department filter functionality
        document.getElementById('departmentFilter').addEventListener('change', function(e) {
            console.log('Selected department:', e.target.value);
            // You can implement filtering logic here based on department
        });
    </script>
</body>
</html>
